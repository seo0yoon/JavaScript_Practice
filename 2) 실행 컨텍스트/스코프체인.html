<script>
  var a = 1;
  function outer() {
    function inner() {
      console.log(a); //undefined 
      var a = 3;
    }
    inner();
    console.log(a); //1
  }
  outer();
  console.log(a) //1

</script>

<!-- 호이스팅 된다고 했을때, 실행 컨텍스트 흐름 -->
<script>
  var a = 1; //(1) 전역컨텍스트가 실행되고 식별자 a가 저장됩니다. 전역 컨텍스트의 외부환경참조 ={x} (2) a에 1이 할당됩니다.
  var outer = function outer() { //(1) 전역 전텍스트가 실행되고 식별자 outer가 저장됩니다. 전역 컨텍스트의 외부환경참조 ={x} (2) outer에 function이 할당됩니다.
    function inner() { //(4) outer 실행 컨텍스트의 환경 레코드에 {inner}식별자가 담기고, 외부환경참조에는 outer함수가 선언될 당시의 렉시컬 환경이 담깁니다. outer 함수는 전역공간에서 선언되었으므로
      // 전역컨텍스트의 렉시컬환경을 참조 복사합니다. => {global {a, outer}} (5) outer 스코프에 있는 변수 inner에 함수를 할당합니다. (7) inner 실행 컨텍스트의 환경 레코드에 {a} 식별자를 저장합니다.
      // 외부환경참조에는 inner함수가 선언될 당시의 렉시컬 환경이 담깁니다. inner함수는 outer함수내부에서 선언돼었으므로 outer 함수의 렉시컬 환경이 됩니다. => {outer {inner}}
      var a;
      console.log(a); //(8)식별자 a에 접근하고자 합니다. a는 선언은되었지만 함수내부에서 값이 할당되지않았습니다. undefined를 출력합니다.
      a = 3; //(9) a에 3을 할당합니다.
    } //(10) inner함수가 종료됩니다. inner 실행 컨텍스트도 종료되고 다시 outer 실행 컨텍스트가 활성화됩니다. => 27번줄로 이동
    inner(); //(6) inner 함수를 호출합니다. outer 실행 컨텍스트는 중단되고, inner 실행 컨텍스트가 활성화됩니다. 
    console.log(a); //(11) 식별자 a에 접근을 합니다. 자바스크립트 엔진은 활성화된 실행 컨텍스트의 렉시컬환경에 접근합니다. 처음 렉시컬 환경에 환경레코드에서 a가 있는지를 찾아보고 있으면 a를 출력하고
    //없으면 외부환경참조의 있는 환경레코드로 넘어갑니다. 코드에서는 전역렉시컬 환경에 a가 있으니 a를 출력합니다. => 1출력 
  }// (12) outer함수가 종료되고, outer 실행 컨텍스트가 사라집니다. 다시 전역 컨텍스트가 활성화됩니다. =>31번줄로 이동
  outer(); //(3) outer 함수를 호출합니다. 이에따라 전역컨텍스트는 중단되고 outer 실행 컨텍스트가 활성화됩니다. (13)
  console.log(a)() //(14) 식별자 a를 찾고 전역 실행 컨텍스트에 렉시컬환경에서 a를 검색합니다. a를 바로 찾을 수 있고, 1을 출력합니다.

</script>